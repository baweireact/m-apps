{"version":3,"sources":["store/book/reducer.ts","store/index.ts","components/Icon.tsx","api/urls.ts","api/index.ts","components/Sidebar.tsx","components/List.tsx","views/Login.tsx","components/Header.tsx","components/Badge.tsx","store/book/actionCreator.ts","components/Footer.tsx","components/Stars.tsx","components/Dialog.tsx","views/Home.tsx","components/MyBookItem.tsx","views/MyBooks.tsx","views/Me.tsx","views/Index.tsx","components/DetailHeader.tsx","views/Detail.tsx","router/Router.tsx","serviceWorker.ts","index.tsx"],"names":["defaultState","title","currentId","isRealScroll","list","myBooks","reducer","state","action","type","newState","JSON","parse","stringify","key","value","reducers","combineReducers","book","store","createStore","applyMiddleware","thunk","subscribe","getState","Icon","props","name","className","onClick","e","urls","login","detail","axios","interceptors","request","use","config","headers","token","localStorage","getItem","error","console","log","Promise","reject","response","res","data","code","alert","message","timer","topArr","common","a","resolve","Api","url","method","getDetail","id","Login","useState","username","setUsername","password","setPassword","visible","setVisible","handleLogin","then","setItem","history","push","onChange","target","placeholder","autoFocus","onKeyUp","keyCode","handleEnter","count","connect","dispatch","onSetState","onDispatch","Badge","children","callback","reduce","total","item","useEffect","actionCreator","to","sidebarDom","map","document","getElementById","scrollIntoView","block","behavior","clearTimeout","setTimeout","Stars","starsDom","i","Dialog","onCancel","onOk","withRouter","checked","avatar","price","stars","setBook","handleCancel","Array","from","getElementsByClassName","offsetTop","Infinity","listDom","category","src","alt","stopPropagation","handleShowDialog","onScroll","scrollTop","length","handleScroll","parseInt","replace","handleInput","operation","handleChecked","ids","totalPrice","filter","checkedAll","every","bookListDom","handleCheckedAll","handleDeleteChecked","Me","renderComponent","Component","path","render","go","match","params","Router","exact","info","component","Index","Detail","Boolean","window","location","hostname","ReactDOM","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.517e76e2.chunk.js","sourcesContent":["import { IBookState, IAction } from '../../types'\r\n\r\nconst defaultState: IBookState = {\r\n  title: '小米书城',\r\n  currentId: 0,\r\n  isRealScroll: true,\r\n  list: [],\r\n  myBooks: []\r\n}\r\n\r\nconst reducer = (state = defaultState, action: IAction) => {\r\n  switch (action.type) {\r\n    case 'SET_STATE':\r\n      let newState = JSON.parse(JSON.stringify(state))\r\n      newState[action.key] = action.value\r\n      return newState\r\n    default:\r\n      return state\r\n  }\r\n}\r\n\r\nexport default reducer","import { createStore, applyMiddleware, combineReducers } from 'redux'\r\nimport thunk from 'redux-thunk'\r\n//import { IState, IAction } from '../interface'\r\nimport book from './book/reducer'\r\n\r\n// const defaultState: IState = {\r\n//   title: '小米书城',\r\n//   currentId: 0,\r\n//   isRealScroll: true,\r\n//   list: [],\r\n//   myBooks: []\r\n// }\r\n\r\n// const reducer = (state = defaultState, action: IAction) => {\r\n//   switch (action.type) {\r\n//     case 'SET_STATE':\r\n//       let newState = JSON.parse(JSON.stringify(state))\r\n//       newState[action.key] = action.value\r\n//       return newState\r\n//     default:\r\n//       return state\r\n//   }\r\n// }\r\n\r\nconst reducers = combineReducers({\r\n  book\r\n})\r\nconst store = createStore(reducers, applyMiddleware(thunk))\r\n\r\nstore.subscribe(() => {\r\n  let state = store.getState()\r\n  //console.log(state)\r\n})\r\n\r\nexport default store","import React, { MouseEvent } from 'react'\r\n\r\ninterface IProps {\r\n  name: string,\r\n  className?: string,\r\n  onClick?: (e: MouseEvent, count: number) => void\r\n}\r\n\r\nconst Icon = (props: IProps) => {\r\n  let { name = \"zhanwei\", className = '', onClick = () => {} } = props\r\n  return (\r\n    <span className={`icon iconfont icon-${name} ${className}`} onClick={(e) => onClick(e, 1)}></span>\r\n  )\r\n}\r\n\r\nexport default Icon\r\n","const urls = {\r\n  login: '/api/login',\r\n  list: '/api/list',\r\n  myBooks: '/api/my_books',\r\n  detail: '/api/detail/'\r\n}\r\n\r\nexport default urls","import axios, { AxiosRequestConfig } from 'axios'\r\nimport urls from './urls'\r\n\r\nif (process.env.NODE_ENV === 'development') {\r\n  axios.defaults.baseURL = 'http://localhost:84'\r\n}\r\n\r\naxios.interceptors.request.use((config) => {\r\n  config.headers.token = localStorage.getItem('token')\r\n  return config\r\n}, (error) => {\r\n  console.log('对请求错误做些什么', error)\r\n  return Promise.reject(error);\r\n})\r\n\r\naxios.interceptors.response.use((res) => {\r\n  if (res.data.code === 400) {\r\n    alert(res.data.message)\r\n  }\r\n  return res\r\n}, (error) => {\r\n  console.log('对响应错误做些什么')\r\n  return Promise.reject(error)\r\n})\r\n\r\nconst common = async (config:AxiosRequestConfig) => {\r\n  let resolve = await axios(config)\r\n  return resolve.data\r\n}\r\n\r\nconst Api = {\r\n  login: (data: object) => common({ url: urls.login, data, method: 'post' }),\r\n  list: () => common({ url: urls.list }),\r\n  myBooks: (data: object, method: AxiosRequestConfig['method']) => common({ url: urls.myBooks, data, method }),\r\n  getDetail: (id: string) => common({url: urls.detail + id})\r\n}\r\n\r\nexport default Api\r\n\r\n\r\n\r\n\r\n","import React, { Dispatch } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { IStore, IList } from '../types'\r\n\r\ninterface IProps {\r\n  list: IList[],\r\n  currentId: number,\r\n  onSetState: (key: string, value: any) => void\r\n  onDispatch: (action: Function) => void\r\n}\r\n\r\nlet timer: any\r\nconst Sidebar = (props: IProps) => {\r\n  const { list, currentId } = props\r\n\r\n  const handleNav = (id: number) => {\r\n    props.onSetState('currentId', id);\r\n    props.onSetState('isRealScroll', false)\r\n    //@ts-ignore\r\n    document.getElementById(id + '').scrollIntoView({ block: 'start', behavior: 'smooth' })\r\n\r\n    clearTimeout(timer)\r\n    timer = setTimeout(() => {\r\n      props.onSetState('isRealScroll', true)\r\n    }, 1000)\r\n  }\r\n\r\n  const sidebarDom = list.map((item: IList) => (\r\n    <div key={item.id} className={`m-sidebar-item ${currentId === item.id ? 'active' : ''}`} onClick={() => handleNav(item.id) }>{item.title}</div>\r\n  ))\r\n\r\n  return (\r\n    <div className=\"m-sidebar\">\r\n      {sidebarDom}\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: IStore) => {\r\n  return {\r\n    list: state.book.list,\r\n    currentId: state.book.currentId\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Sidebar)\r\n","import React, { Dispatch, useState, useEffect, MouseEvent, ChangeEvent } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\r\nimport { IStore, IList, IBook } from '../types'\r\nimport Stars from './Stars'\r\nimport Dialog from './Dialog'\r\nimport actionCreator from '../store/book/actionCreator'\r\n\r\ninterface IProps extends RouteComponentProps {\r\n  list: IList[],\r\n  isRealScroll: boolean,\r\n  onSetState: (key: string, value: any) => void,\r\n  onDispatch: (action: Function) => void\r\n}\r\n\r\nlet topArr:number[]\r\n\r\nconst List = (props: IProps) => {\r\n  let { list, isRealScroll } = props\r\n  const [ visible, setVisible ] = useState<boolean>(false)\r\n  let [ book, setBook ] = useState<IBook>({\r\n    checked: true,\r\n    count: 1,\r\n    id: 1,\r\n    title: '',\r\n    avatar: '',\r\n    price: 0,\r\n    stars: 0\r\n  })\r\n\r\n  const handleShowDialog = (e: MouseEvent, book: any) => {\r\n    e.stopPropagation()\r\n    book.checked = true\r\n    book.count = 1\r\n    setBook(book)\r\n    setVisible(true)\r\n  }\r\n\r\n  const handleInput = (e:ChangeEvent<HTMLInputElement>) => {\r\n    let count = parseInt(e.target.value.replace(/[^\\d]/g, ''))\r\n    if (count === 0) {\r\n      count = 1\r\n    }\r\n    book.count = count\r\n    setBook({...book})\r\n  }\r\n\r\n  const handleAdd = () => {\r\n    book.count++\r\n    setBook({...book})\r\n  }\r\n\r\n  const handleSub = () => {\r\n    if (book.count > 1) {\r\n      book.count--\r\n      setBook({...book})\r\n    }\r\n  }\r\n\r\n  const handleAddToMyBooks = () => {\r\n    props.onDispatch(actionCreator.myBooks({ book }, 'post', handleCancel))\r\n  }\r\n\r\n  const handleCancel = () => {\r\n    setVisible(false)\r\n  }\r\n\r\n  const handleDetail = (id: number) => {\r\n    props.history.push(`/detail/${id}`)\r\n  }\r\n\r\n  const handleScroll = (e: React.UIEvent<HTMLDivElement, globalThis.UIEvent>) => {\r\n    let scrollTop = (e.target as Element).scrollTop + 40\r\n    if (isRealScroll) {\r\n      for (let i = 0; i < topArr.length - 1; i++) {\r\n        if (topArr[i] <= scrollTop && scrollTop < topArr[i + 1]) {\r\n          props.onSetState('currentId', i)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    topArr = Array.from(document.getElementsByClassName('js-category')).map((item:any) => item.offsetTop)\r\n    topArr.push(Infinity)\r\n  }, [props.list])\r\n\r\n  let listDom = list.map(category => (\r\n    <div key={category.id} id={category.id + ''} className=\"js-category\">\r\n      <div className=\"m-category-title\">{category.title}</div>\r\n      {\r\n        category.list.map((book: IBook) => (\r\n          <div key={book.id} className=\"m-list-item\" onClick={() => handleDetail(book.id)}>\r\n            <div className=\"m-img-wrap\">\r\n              <img src={book.avatar} alt={book.title} className=\"m-img\"></img>\r\n            </div>\r\n            <div className=\"m-list-info\">\r\n              {book.title}\r\n              <Stars count={book.stars}></Stars>\r\n              <button className=\"m-btn\" onClick={ (e) => handleShowDialog(e, book) }>添加</button>\r\n            </div>\r\n          </div>\r\n        ))\r\n      }\r\n    </div>\r\n  ))\r\n\r\n  return (\r\n    <div className=\"m-list\" onScroll={(e) => handleScroll(e) }>\r\n      {listDom}\r\n      <Dialog title=\"添加\" visible={visible} onOk={ () => handleAddToMyBooks() } onCancel={() => handleCancel()}>\r\n        <div className=\"m-add-wrap\">\r\n            <div className=\"m-add-info\">\r\n              <button className=\"m-btn\" onClick={() => handleSub()}>-</button>\r\n              <input value={book.count} placeholder=\"数量\" className=\"m-input\" onChange={(e) => handleInput(e)} ></input>\r\n              <button className=\"m-btn\" onClick={() => handleAdd()} >+</button>\r\n            </div>\r\n          </div>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: IStore) => {\r\n  return {\r\n    list: state.book.list,\r\n    currentId: state.book.currentId,\r\n    isRealScroll: state.book.isRealScroll\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(withRouter(List))\r\n\r\n","import React, { useState, MouseEvent, KeyboardEvent } from 'react'\r\nimport { RouteComponentProps } from 'react-router-dom'\r\nimport Icon from '../components/Icon'\r\nimport Api from '../api'\r\n\r\nconst Login = (props: RouteComponentProps) => {\r\n  const [ username, setUsername ] = useState('admin')\r\n  const [ password, setPassword ] = useState('123456')\r\n  const [ visible, setVisible ] = useState(false)\r\n\r\n  const handleVisible = (e: MouseEvent, count: number ) => {\r\n    setVisible(!visible)\r\n  }\r\n\r\n  const handleEnter = (e: KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.keyCode === 13 ) {\r\n      handleLogin()\r\n    }\r\n  }\r\n\r\n  const handleLogin = () => {\r\n    Api.login({ username, password }).then(res => {\r\n      if (res.code === 200) {\r\n        localStorage.setItem('token', res.data.username)\r\n        props.history.push('/index/home')\r\n      }\r\n    })\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <div>\r\n        <input value={username} onChange={(e) => setUsername(e.target.value)} placeholder=\"请输入用户名\" autoFocus></input>\r\n      </div>\r\n      <div>\r\n        <input value={password} onChange={(e) => setPassword(e.target.value)} onKeyUp={ (e) => handleEnter(e)  } placeholder=\"请输入密码\" type={ visible ? 'text' : 'password' }></input>\r\n        <Icon name={ visible ? 'show' : 'hide' } onClick={ (e, count) => handleVisible(e, count) } className=\"m-login-icon\"></Icon>\r\n      </div>\r\n      <button onClick={() => handleLogin()}>登录</button>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Login\r\n","import React, { Dispatch } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { IStore } from '../types'\r\n\r\ninterface IProps {\r\n  title: string\r\n}\r\n\r\nconst Header = (props: IProps) => {\r\n  const { title } = props\r\n  return (\r\n    <div className=\"m-header\">\r\n      {title}\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: IStore) => {\r\n  return {\r\n    title: state.book.title\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Header)\r\n","import React, { ReactElement } from 'react'\r\n\r\ninterface IProp {\r\n  count: number | string,\r\n  children: ReactElement\r\n}\r\n\r\nconst Badge = (props: IProp) => {\r\n  let { count, children } = props\r\n  if (count > 99) {\r\n    count = '99+'\r\n  }\r\n  return (\r\n    <span className=\"m-badge-wrap\">\r\n      { (typeof count === 'string' || count > 0) && <span className=\"m-badge\">{count}</span>}\r\n      {children}\r\n    </span>\r\n  )\r\n}\r\n\r\n\r\nexport default Badge\r\n","import { Dispatch } from 'react'\r\nimport { Method } from 'axios'\r\nimport Api from '../../api'\r\n\r\nconst list = () => (dispatch: Dispatch<any>) => {\r\n  Api.list().then(res => {\r\n    if (res.code === 200) {\r\n      dispatch({ type: 'SET_STATE', key: 'list', value: res.data })\r\n    }\r\n  })\r\n}\r\n\r\nconst myBooks = (data: any = null, method: Method = 'get', callback?: Function) => (dispatch: Dispatch<any>) => {\r\n  Api.myBooks(data, method).then(res => {\r\n    if (res.code === 200) {\r\n      dispatch({ type: 'SET_STATE', key: 'myBooks', value: res.data })\r\n      callback && callback()\r\n    }\r\n  })\r\n}\r\n\r\n\r\nexport default {\r\n  list,\r\n  myBooks\r\n}","import React, { Dispatch, useEffect } from 'react'\r\nimport { NavLink } from 'react-router-dom'\r\nimport { connect } from 'react-redux'\r\nimport { IStore, IBook } from '../types'\r\nimport Icon from './Icon'\r\nimport Badge from './Badge'\r\nimport actionCreator from '../store/book/actionCreator'\r\n\r\ninterface IProps {\r\n  myBooks: IBook[],\r\n  onSetState: (key: string, value: any) => void\r\n  onDispatch: (action: Function) => void\r\n}\r\n\r\nconst Footer = (props: IProps) => {\r\n  let { myBooks, onDispatch } = props\r\n\r\n  let count = myBooks.reduce((total, item) => {\r\n    return total + item.count\r\n  }, 0)\r\n\r\n  const handleNav = (title: string) => {\r\n    //props.onSetState('title', title)\r\n  }\r\n\r\n  useEffect(() => {\r\n    onDispatch(actionCreator.myBooks())\r\n  }, [onDispatch])\r\n\r\n  return (\r\n    <div className=\"m-footer\">\r\n      <NavLink to=\"/index/home\" className=\"m-footer-item\" onClick={() => handleNav('小米书城')}>\r\n        <Icon name=\"home\" className=\"m-footer-icon\"></Icon>\r\n        <div className=\"m-footer-text\">首页</div>\r\n      </NavLink>\r\n      <NavLink to=\"/index/my_books\" className=\"m-footer-item\" onClick={() => handleNav('我的书包')}>\r\n        <Badge count={count}>\r\n          <Icon name=\"shubao\" className=\"m-footer-icon\"></Icon>\r\n        </Badge>\r\n        <div className=\"m-footer-text\">书包</div>\r\n      </NavLink>\r\n      <NavLink to=\"/index/me\" className=\"m-footer-item\" onClick={() => handleNav('个人中心')}>\r\n        <Icon name=\"me\" className=\"m-footer-icon\"></Icon>\r\n        <div className=\"m-footer-text\">我的</div>\r\n      </NavLink>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: IStore) => {\r\n  return {\r\n    myBooks: state.book.myBooks\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Footer)\r\n","import React from 'react'\r\nimport Icon from './Icon'\r\n\r\ninterface IProps {\r\n  count: number\r\n}\r\n\r\nconst Stars = (props: IProps) => {\r\n  let { count } = props\r\n\r\n  const starsDom = []\r\n  for (let i = 0; i < 5; i++) {\r\n    starsDom.push(<Icon name=\"star\" key={i} className={`m-star ${ i < count ? 'active' : '' }`}></Icon>)\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      {starsDom}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Stars\r\n","import React, { ReactElement } from 'react'\r\nimport Icon from './Icon'\r\n\r\ninterface IProp {\r\n  title: string,\r\n  visible: boolean,\r\n  children: ReactElement,\r\n  onOk: () => void,\r\n  onCancel: () => void\r\n}\r\n\r\nconst Dialog = (props: IProp) => {\r\n  let { visible, title, children } = props\r\n  return (\r\n    <div className={\"m-dialog-wrap \" + (visible ? 'active' : '')}>\r\n      <div className=\"m-dialog\">\r\n        <div className=\"m-dialog-header\">\r\n          <div className=\"m-dialog-title\" >{title}</div>\r\n          <Icon name=\"guanbi\" className=\"m-dialog-close\" onClick={props.onCancel}></Icon>\r\n        </div>\r\n        <div className=\"m-dialog-content\">\r\n          {children}\r\n        </div>\r\n        <div className=\"m-dialog-footer\">\r\n          <button className=\"m-btn\" onClick={props.onCancel}>取消</button>\r\n          <button className=\"m-btn\" onClick={props.onOk}>确定</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Dialog\r\n","import React, { useEffect, Dispatch } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport Sidebar from '../components/Sidebar'\r\nimport List from '../components/List'\r\nimport actionCreator from '../store/book/actionCreator'\r\n\r\ninterface IProps {\r\n  onSetState: (key: string, value: any) => void\r\n  onDispatch: (action: Function) => void\r\n}\r\n\r\nconst Home = (props: IProps) => {\r\n  let { onDispatch } = props\r\n\r\n  useEffect(() => {\r\n    onDispatch(actionCreator.list())\r\n  }, [onDispatch])\r\n\r\n  return (\r\n    <div className=\"m-main m-home\">\r\n      <Sidebar></Sidebar>\r\n      <List></List>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = () => {\r\n  return {\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Home)\r\n","import React, { Dispatch, ChangeEvent } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { IBook, IStore } from '../types'\r\nimport actionCreator from '../store/book/actionCreator'\r\n\r\ninterface IProps {\r\n  book: IBook,\r\n  onSetState: (key: string, value: any) => void\r\n  onDispatch: (action: Function) => void\r\n}\r\n\r\nconst MyBookItem = (props: IProps) => {\r\n  let { book, onDispatch } = props\r\n\r\n  const handleChecked = (id: number, e: ChangeEvent<HTMLInputElement>) => {\r\n    onDispatch(actionCreator.myBooks({ id, operation: 'checked', checked: e.target.checked }, 'patch' ))\r\n  }\r\n\r\n  const handleSub = (id: number) => {\r\n    onDispatch(actionCreator.myBooks({ id, operation: 'add' }, 'patch' ))\r\n  }\r\n\r\n  const handleInput = (id:number, e:ChangeEvent<HTMLInputElement>) => {\r\n    let count = parseInt(e.target.value.replace(/[^\\d]/g, ''))\r\n    if (count === 0) {\r\n      count = 1\r\n    }\r\n    onDispatch(actionCreator.myBooks({ id, operation: 'inputCount', count }, 'patch' ))\r\n  }\r\n\r\n  const handleAdd = (id: number) => {\r\n    onDispatch(actionCreator.myBooks({ id, operation: 'add' }, 'patch' ))\r\n  }\r\n\r\n  const handleDelete = (ids: number[]) => {\r\n    onDispatch(actionCreator.myBooks({ ids }, 'delete' ))\r\n  }\r\n\r\n\r\n  return (\r\n    <div className=\"m-my-books-item\">\r\n    <div className=\"m-my-books-checkbox-wrap\" >\r\n      <input type=\"checkbox\" checked={book.checked} onChange={ (e) => handleChecked(book.id, e) } className=\"m-my-books-checkbox\" />\r\n    </div>\r\n    <div className=\"m-my-books-img-wrap\">\r\n      <img src={book.avatar} className=\"m-my-books-img\" alt={book.title}/>\r\n    </div>\r\n    <div className=\"m-my-books-info\">\r\n      <div>{book.title}</div>\r\n      <div>￥{book.price}</div>\r\n      <div className=\"m-add-info\">\r\n        <button className=\"m-btn\" onClick={ () => handleSub(book.id)}>减</button>\r\n        <input type=\"text\" value={book.count} placeholder=\"数量\" className=\"m-input\" onChange={ (e) => handleInput(book.id, e)}/>\r\n        <button className=\"m-btn\" onClick={ () => handleAdd(book.id)} >加</button>\r\n        <button className=\"m-btn\" onClick={ () => handleDelete([book.id])}>删除</button>\r\n      </div>        \r\n    </div>\r\n  </div> \r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: IStore) => {\r\n  return {\r\n    myBooks: state.book.myBooks\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MyBookItem)\r\n\r\n","import React, { useState, Dispatch, ChangeEvent } from 'react'\r\nimport { connect } from 'react-redux'\r\nimport { IStore, IBook } from '../types'\r\nimport actionCreator from '../store/book/actionCreator'\r\nimport MyBookItem from '../components/MyBookItem'\r\nimport Dialog from '../components/Dialog'\r\n\r\ninterface IProps {\r\n  myBooks: IBook[],\r\n  onSetState: (key: string, value: any) => void\r\n  onDispatch: (action: Function) => void\r\n}\r\nconst MyBooks = (props: IProps) => {\r\n  let { myBooks, onDispatch } = props\r\n  const [ visible, setVisible ] = useState(false)\r\n\r\n  const handleShowDialog = () => {\r\n    if (myBooks.filter(item => item.checked).length === 0) {\r\n      //this.$message({ message: '请选择要删除的商品哦~', duration: 2000 })\r\n      alert('请选择要删除的商品哦~')\r\n    } else {\r\n      setVisible(true)\r\n    }\r\n  }\r\n\r\n  const handleCancel = () => {\r\n    setVisible(false)\r\n  }\r\n\r\n  const handleDeleteChecked = () => {\r\n    let ids = myBooks.filter(item => item.checked).map(item => item.id)\r\n    onDispatch(actionCreator.myBooks({ ids }, 'delete', () => {\r\n      handleCancel()\r\n    } ))\r\n  }\r\n\r\n  const handleCheckedAll = (e: ChangeEvent<HTMLInputElement>) => {\r\n    onDispatch(actionCreator.myBooks({ operation: 'checkedAll', checked: e.target.checked }, 'patch' ))\r\n  }\r\n\r\n  let totalPrice = myBooks.filter(item => item.checked).reduce((total, item) => total + item.count * item.price, 0)\r\n  let checkedAll = myBooks.every(item => item.checked)\r\n\r\n  let bookListDom = myBooks.map(item => (\r\n    <MyBookItem key={item.id} book={item}></MyBookItem>\r\n  ))\r\n\r\n  return (\r\n    <div className=\"m-main\">\r\n      {\r\n        myBooks.length > 0 ?\r\n        <div className=\"m-my-books\">\r\n          <div className=\"m-my-books-content\">\r\n            {bookListDom}\r\n          </div>\r\n          <div className=\"m-my-books-footer\">\r\n            <label>\r\n              <input type=\"checkbox\" checked={checkedAll} onChange={ (e) => handleCheckedAll(e)}/>\r\n              <span>全选</span>\r\n            </label>\r\n            <button onClick={ () => handleShowDialog() }>删除</button>\r\n            <span>\r\n              合计: ￥{totalPrice}\r\n            </span>\r\n          </div>\r\n        </div>\r\n        :\r\n        <div className=\"m-my-books-empty\">\r\n          购物车空空如也~\r\n        </div>\r\n      }\r\n      <Dialog visible={visible} title=\"删除\" onOk={() => handleDeleteChecked()} onCancel={() => handleCancel()}>\r\n        <div className=\"m-my-books-delete-dialog-info\">\r\n          您确定要删除选中的商品吗？\r\n        </div>\r\n      </Dialog>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = (state: IStore) => {\r\n  return {\r\n    myBooks: state.book.myBooks\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(MyBooks)\r\n","import React from 'react'\r\n\r\nconst Me = () => {\r\n  return (\r\n    <div className=\"m-main\">\r\n      个人中心\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Me\r\n","import React, { Dispatch, ReactElement } from 'react'\r\nimport Header from '../components/Header'\r\nimport Footer from '../components/Footer'\r\nimport { Switch, Route } from 'react-router-dom'\r\nimport { connect } from 'react-redux'\r\nimport Home from './Home'\r\nimport MyBooks from './MyBooks'\r\nimport Me from './Me'\r\n\r\ninterface IProps {\r\n  onSetState: (key: string, value: any) => void\r\n  onDispatch: (action: Function) => void\r\n}\r\n\r\nconst Index = (props: IProps) => {\r\n  const renderComponent = (Component: ReactElement, title: string) => {\r\n    setTimeout(() => {\r\n      props.onSetState('title', title)\r\n    })\r\n    \r\n    return Component\r\n  }\r\n\r\n  return (\r\n    <div className=\"m-wrap\">\r\n      <Header></Header>\r\n      <Switch>\r\n        <Route path=\"/index/home\" render={() => renderComponent(<Home></Home>, '小米书城')}></Route>\r\n        <Route path=\"/index/my_books\" render={() => renderComponent(<MyBooks></MyBooks>, '我的书包')}></Route>\r\n        <Route path=\"/index/me\" render={() => renderComponent(<Me></Me>, '个人中心')}></Route>\r\n      </Switch>\r\n      <Footer></Footer>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapStateToProps = () => {\r\n  return {\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Index)\r\n","import React from 'react'\r\nimport { withRouter, RouteComponentProps } from 'react-router-dom'\r\nimport Icon from './Icon'\r\n\r\ninterface IProp extends RouteComponentProps {\r\n  title: string\r\n}\r\n\r\nconst DetailHeader = (props: IProp) => {\r\n  let { title } = props\r\n\r\n  const handleBack = () => {\r\n    props.history.go(-1)\r\n  }\r\n\r\n  return (\r\n    <div className=\"m-detail-header\">\r\n      <Icon name=\"back\" className=\"m-detail-header-icon\" onClick={() => handleBack()}></Icon>\r\n      <div className=\"m-detail-header-info\">{title}</div>\r\n      <Icon name=\"fenxiang\" className=\"m-detail-header-icon\"></Icon>\r\n      <Icon name=\"more\" className=\"m-detail-header-icon\"></Icon>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default withRouter(DetailHeader)\r\n","import React, { useState, useEffect, ChangeEvent, Dispatch } from 'react'\r\nimport { RouteComponentProps } from 'react-router-dom'\r\nimport { connect } from 'react-redux'\r\nimport DetailHeader from '../components/DetailHeader'\r\nimport Api from '../api'\r\nimport actionCreator from '../store/book/actionCreator'\r\n\r\ninterface IProps extends RouteComponentProps {\r\n  onDispatch(action: Function):void\r\n}\r\n\r\nconst Detail = (props: IProps ) => {\r\n  let [ book, setBook ] = useState<any>({ count: 1}) \r\n\r\n  const handleSub = () => {\r\n    if (book.count > 1) {\r\n      book.count--\r\n      setBook({...book})\r\n    }\r\n  }\r\n\r\n  const handleAdd = () => {\r\n    book.count++\r\n    setBook({...book})\r\n  }\r\n\r\n  const handleAddToMyBook = () => {\r\n    props.onDispatch(actionCreator.myBooks({ book }, 'post', () => {\r\n      props.history.push('/index/my_books')\r\n    }))\r\n  }\r\n\r\n  const handleInput = (e: ChangeEvent<HTMLInputElement>) => {\r\n    let count = parseInt(e.target.value.replace(/[^\\d]/g, ''))\r\n    if (count === 0) {\r\n      count = 1\r\n    }\r\n    book.count = count\r\n    setBook({...book})\r\n  }\r\n\r\n\r\n  useEffect(() => {\r\n    //@ts-ignore\r\n    let { id } = props.match.params\r\n    Api.getDetail(id).then(res =>  {\r\n      if (res.code === 200) {\r\n        let book = res.data\r\n        book.count = 1\r\n        book.checked = true\r\n        setBook(book)\r\n      }\r\n    })\r\n  }, [props])\r\n  \r\n  return (\r\n    <div>\r\n      <DetailHeader title={book.title}></DetailHeader>\r\n      <div className=\"m-detail-img-wrap\">\r\n        <img src={book.avatar} alt={book.title}></img>\r\n      </div>\r\n      <div>\r\n        <div className=\"m-add-info\">\r\n          <button className=\"m-btn\" onClick={() => handleSub()}>-</button>\r\n          <input value={book.count} placeholder=\"数量\" className=\"m-input\" onChange={(e) => handleInput(e)} ></input>\r\n          <button className=\"m-btn\" onClick={() => handleAdd()} >+</button>\r\n          <button className=\"m-btn\" onClick={() => handleAddToMyBook()}>添加</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch<any>) => {\r\n  return {\r\n    onSetState(key: string, value: any) {\r\n      dispatch({ type: 'SET_STATE', key, value })\r\n    },\r\n    onDispatch(action: Function) {\r\n      dispatch(action)\r\n    }\r\n  }\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(Detail)\r\n","import React, { Component } from 'react'\r\nimport { Switch, Route, Redirect } from \"react-router-dom\"\r\nimport Login from '../views/Login'\r\nimport Index from '../views/Index'\r\nimport Detail from '../views/Detail'\r\n\r\nexport default class Router extends Component {\r\n  render() {\r\n    return (\r\n      <Switch>\r\n        <Redirect from=\"/\" to=\"/login\" exact></Redirect>\r\n        <Route path=\"/login\" render={(info) => <Login {...info}></Login>}></Route>\r\n        <Route path=\"/index\" component={Index}></Route>\r\n        <Route path=\"/detail/:id\" component={Detail}></Route>\r\n      </Switch>\r\n    )\r\n  }\r\n}\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux'\nimport { BrowserRouter } from \"react-router-dom\";\nimport store from './store/index'\nimport Router from './router/Router'\nimport './font/iconfont.css'\nimport './index.css';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <Provider store={store}>\n    <BrowserRouter>\n      <Router></Router>\n    </BrowserRouter>\n  </Provider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}